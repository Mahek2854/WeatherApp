# Server Configuration - REMOVED CONTEXT PATH FOR SIMPLICITY
server.port=8080
# server.servlet.context-path=/weather-app  # COMMENTED OUT

# Database Configuration (H2 for development)
spring.datasource.url=jdbc:h2:mem:weatherdb
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=
spring.h2.console.enabled=true
spring.h2.console.path=/h2-console

# JPA Configuration
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true

# Thymeleaf Configuration
spring.thymeleaf.cache=false
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html

# IMPORTANT: Static Resources Configuration
spring.web.resources.static-locations=classpath:/static/
spring.web.resources.cache.period=0
spring.mvc.static-path-pattern=/static/**

# STANDARDIZED: OpenWeatherMap API Configuration
openweathermap.api.key=61457956659eec8e4068cf5aecf8f337
openweathermap.api.base-url=https://api.openweathermap.org/data/2.5
openweathermap.api.onecall-url=https://api.openweathermap.org/data/2.5/onecall
openweathermap.api.units=metric

# Weather API Configuration (Legacy - keeping for backward compatibility)
weather.api.url=https://api.openweathermap.org/data/2.5/weather
weather.api.base-url=https://api.openweathermap.org/data/2.5
weather.api.onecall-url=https://api.openweathermap.org/data/2.5/onecall
weather.api.key=61457956659eec8e4068cf5aecf8f337
weather.api.units=metric

# UPDATED: OpenWeatherMap One Call API 3.0 for Alerts (REQUIRED FOR REAL-TIME ALERTS)
weather.api.onecall.v3.url=https://api.openweathermap.org/data/3.0/onecall
weather.api.alerts.url=https://api.openweathermap.org/data/3.0/onecall

# National Weather Service API (US Only - No API Key Required)
nws.api.base.url=https://api.weather.gov
nws.api.alerts.url=https://api.weather.gov/alerts/active

# FIXED: Location API Configuration (Free IP-API service - no key required)
location.url=http://ip-api.com/json/
location.key=
location.format=

# Geocoding API Configuration
geocoding.api.url=https://api.openweathermap.org/geo/1.0/direct
geocoding.api.key=61457956659eec8e4068cf5aecf8f337
geocoding.api.limit=5

# Air Quality API
air.quality.api.url=https://api.openweathermap.org/data/2.5/air_pollution
air.quality.api.key=61457956659eec8e4068cf5aecf8f337

# Weather Forecast API
weather.forecast.url=https://api.openweathermap.org/data/2.5/forecast

# NEW: Weather Alerts Configuration
weather.alerts.enabled=true
weather.alerts.refresh.interval=900000
weather.alerts.cache.duration=300000
weather.alerts.default.location.lat=40.7128
weather.alerts.default.location.lon=-74.0060

# NEW: HTTP Client Configuration for External APIs
spring.http.client.timeout=10000
spring.http.client.connection-timeout=5000
spring.http.client.read-timeout=10000

# NEW: CORS Configuration for API endpoints
spring.web.cors.allowed-origins=*
spring.web.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
spring.web.cors.allowed-headers=*

# Caching Configuration
spring.cache.type=caffeine
spring.cache.caffeine.spec=maximumSize=1000,expireAfterWrite=30m

# NEW: Enhanced Caching for Weather Data
spring.cache.cache-names=weather-alerts,weather-current,weather-forecast
spring.cache.caffeine.spec.weather-alerts=maximumSize=100,expireAfterWrite=15m
spring.cache.caffeine.spec.weather-current=maximumSize=500,expireAfterWrite=10m
spring.cache.caffeine.spec.weather-forecast=maximumSize=200,expireAfterWrite=30m

# Logging Configuration
logging.level.com.example.weather=DEBUG
logging.level.org.springframework.web=INFO
logging.level.org.springframework.web.client=DEBUG
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n

# NEW: Weather Service Specific Logging
logging.level.com.example.weather.service.WeatherAlertsService=INFO
logging.level.org.springframework.web.client.RestTemplate=DEBUG

# Actuator Configuration
management.endpoints.web.exposure.include=health,info,metrics,weather-alerts
management.endpoint.health.show-details=always

# NEW: Custom Health Indicators
management.health.weather-api.enabled=true
management.health.nws-api.enabled=true

# NEW: Rate Limiting Configuration (to avoid API limits)
weather.api.rate.limit.requests=60
weather.api.rate.limit.window=60000

# NEW: Fallback Configuration
weather.alerts.fallback.enabled=true
weather.alerts.sample.data.enabled=false

# NEW: Notification Configuration
weather.notifications.email.enabled=false
weather.notifications.sms.enabled=false
weather.notifications.push.enabled=true

# NEW: Security Configuration for API endpoints
spring.security.enabled=false

# IMPORTANT: Enable real API calls
weather.use.real.api=true
weather.mock.data.enabled=false
